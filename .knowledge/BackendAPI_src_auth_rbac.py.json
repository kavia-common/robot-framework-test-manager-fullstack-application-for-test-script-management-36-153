{"is_source_file": true, "format": "Python", "description": "This source file implements Role-Based Access Control (RBAC) for a FastAPI application. It defines permission constants, role permissions mappings, and functions/dependencies for authenticating users, retrieving their roles, checking permissions, and enforcing permission requirements through dependencies.", "external_files": ["../database/connection", "../database/models", ".jwt_handler"], "external_methods": ["decode_access_token", "get_db"], "published": ["get_current_user", "get_user_roles", "user_has_permission", "require_permission", "require_admin", "require_tester", "require_viewer"], "classes": [{"name": "Permission", "description": "Class containing string constants for various permissions used in RBAC."}], "methods": [{"name": "User get_current_user( credentials: HTTPAuthorizationCredentials = Depends(security), db: Session = Depends(get_db) )", "description": "Asynchronously retrieves the currently authenticated user by decoding the JWT token and querying the database.", "scope": "", "scopeKind": ""}, {"name": "List[UserRoleEnum] get_user_roles(user: User, db: Session)", "description": "Fetches all roles assigned to a user from the database.", "scope": "", "scopeKind": ""}, {"name": "bool user_has_permission(user: User, permission: str, db: Session)", "description": "Checks if a user has a specific permission based on their roles.", "scope": "", "scopeKind": ""}, {"name": "require_permission(permission: str)", "description": "Creates a dependency function that ensures a user has a specific permission.", "scope": "", "scopeKind": ""}, {"name": "permission_checker( current_user: User = Depends(get_current_user), db: Session = Depends(get_db) )", "scope": "require_permission", "scopeKind": "function", "description": "unavailable"}], "calls": ["decode_access_token", "get_db", "db.query(User).filter(User.username == username).first()", "db.query(UserRoleModel).filter(UserRoleModel.user_id == user.id).all()", "db.query(Role).filter(Role.id == user_role.role_id).first()"], "search-terms": ["RBAC", "Permission constants", "role_permissions mapping", "get_current_user dependency", "user permission check", "FastAPI security", "authentication with JWT"], "state": 2, "file_id": 8, "knowledge_revision": 24, "git_revision": "", "revision_history": [{"17": ""}, {"24": ""}], "ctags": [{"_type": "tag", "name": "CREATE_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    CREATE_TEST_CASE = \"create_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "CREATE_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    CREATE_TEST_SCRIPT = \"create_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "DELETE_HISTORY", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    DELETE_HISTORY = \"delete_history\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "DELETE_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    DELETE_TEST_CASE = \"delete_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "DELETE_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    DELETE_TEST_SCRIPT = \"delete_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "EXECUTE_TEST", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    EXECUTE_TEST = \"execute_test\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "MANAGE_QUEUE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    MANAGE_QUEUE = \"manage_queue\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "MANAGE_ROLES", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    MANAGE_ROLES = \"manage_roles\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "MANAGE_USERS", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    MANAGE_USERS = \"manage_users\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "Permission", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^class Permission:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "READ_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    READ_TEST_CASE = \"read_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "READ_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    READ_TEST_SCRIPT = \"read_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "ROLE_PERMISSIONS", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^ROLE_PERMISSIONS = {$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "UPDATE_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    UPDATE_TEST_CASE = \"update_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "UPDATE_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    UPDATE_TEST_SCRIPT = \"update_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "UserRoleEnum", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^from ..database.models import User, Role, UserRole as UserRoleModel, UserRole as UserRoleEnum$/", "language": "Python", "kind": "unknown", "nameref": "unknown:UserRole"}, {"_type": "tag", "name": "UserRoleModel", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^from ..database.models import User, Role, UserRole as UserRoleModel, UserRole as UserRoleEnum$/", "language": "Python", "kind": "unknown", "nameref": "unknown:UserRole"}, {"_type": "tag", "name": "VIEW_AUDIT_LOGS", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    VIEW_AUDIT_LOGS = \"view_audit_logs\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "VIEW_HISTORY", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    VIEW_HISTORY = \"view_history\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^async def get_current_user($/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "( credentials: HTTPAuthorizationCredentials = Depends(security), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "get_user_roles", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^def get_user_roles(user: User, db: Session) -> List[UserRoleEnum]:$/", "language": "Python", "typeref": "typename:List[UserRoleEnum]", "kind": "function", "signature": "(user: User, db: Session)"}, {"_type": "tag", "name": "permission_checker", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    def permission_checker($/", "file": true, "language": "Python", "kind": "function", "signature": "( current_user: User = Depends(get_current_user), db: Session = Depends(get_db) )", "scope": "require_permission", "scopeKind": "function"}, {"_type": "tag", "name": "require_admin", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^require_admin = require_permission(Permission.MANAGE_USERS)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "require_permission", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^def require_permission(permission: str):$/", "language": "Python", "kind": "function", "signature": "(permission: str)"}, {"_type": "tag", "name": "require_tester", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^require_tester = require_permission(Permission.EXECUTE_TEST)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "require_viewer", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^require_viewer = require_permission(Permission.READ_TEST_SCRIPT)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "security", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^security = HTTPBearer()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "user_has_permission", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^def user_has_permission(user: User, permission: str, db: Session) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(user: User, permission: str, db: Session)"}], "hash": "746b890ea344fe050c1d99fbe143df18", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/src/auth/rbac.py", "fields": [{"name": "CREATE_TEST_CASE = \"create_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "CREATE_TEST_SCRIPT = \"create_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "DELETE_HISTORY = \"delete_history\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "DELETE_TEST_CASE = \"delete_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "DELETE_TEST_SCRIPT = \"delete_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "EXECUTE_TEST = \"execute_test\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "MANAGE_QUEUE = \"manage_queue\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "MANAGE_ROLES = \"manage_roles\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "MANAGE_USERS = \"manage_users\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "READ_TEST_CASE = \"read_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "READ_TEST_SCRIPT = \"read_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "ROLE_PERMISSIONS = {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UPDATE_TEST_CASE = \"update_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "UPDATE_TEST_SCRIPT = \"update_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "VIEW_AUDIT_LOGS = \"view_audit_logs\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "VIEW_HISTORY = \"view_history\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "require_admin = require_permission(Permission.MANAGE_USERS)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "require_tester = require_permission(Permission.EXECUTE_TEST)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "require_viewer = require_permission(Permission.READ_TEST_SCRIPT)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "security = HTTPBearer()", "scope": "", "scopeKind": "", "description": "unavailable"}]}