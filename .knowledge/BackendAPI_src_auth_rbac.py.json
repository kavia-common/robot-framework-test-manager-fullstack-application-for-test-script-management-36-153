{"is_source_file": true, "format": "Python", "description": "This file defines role-based access control (RBAC) permissions, role-permission mappings, and FastAPI dependencies for user authentication and authorization within a web application. It includes permission constants, functions to retrieve current user info, roles, and check permissions, as well as permission-decorating utilities.", "external_files": ["../database/connection", "../database/models", ".jwt_handler"], "external_methods": ["get_db", "User", "Role", "UserRole as UserRoleModel", "decode_access_token"], "published": ["get_current_user", "get_user_roles", "user_has_permission", "require_permission", "require_admin", "require_tester", "require_viewer"], "classes": [{"name": "Permission", "description": "A class containing constants that represent various permissions within the RBAC system."}], "methods": [{"name": "User get_current_user( credentials: HTTPAuthorizationCredentials = Depends(security), db: Session = Depends(get_db) )", "description": "Asynchronously retrieves the current authenticated user based on the Bearer token. Validates token, retrieves user from database, and checks if user is active.", "scope": "", "scopeKind": ""}, {"name": "List[UserRoleEnum] get_user_roles(user: User, db: Session)", "description": "Retrieves a list of roles assigned to a user from the database.", "scope": "", "scopeKind": ""}, {"name": "bool user_has_permission(user: User, permission: str, db: Session)", "description": "Checks whether a given user has a specific permission by examining their roles and the role-permissions mapping.", "scope": "", "scopeKind": ""}, {"name": "require_permission(permission: str)", "description": "A decorator factory that provides a dependency which enforces that the current user has a specified permission. Raises HTTP 403 if permission is lacking.", "scope": "", "scopeKind": ""}, {"name": "permission_checker( current_user: User = Depends(get_current_user), db: Session = Depends(get_db) )", "scope": "require_permission", "scopeKind": "function", "description": "unavailable"}], "calls": ["decode_access_token", "db.query", "db.first", "db.all", "roles in ROLE_PERMISSIONS", "user_has_permission"], "search-terms": ["RBAC", "role permissions map", "get_current_user", "FastAPI dependencies", "permission check", "user roles", "JWT token validation", "authorization"], "state": 2, "file_id": 8, "knowledge_revision": 79, "git_revision": "a629b5b37c9b16cb48c78d6cf5fe937d10ef54ad", "revision_history": [{"17": ""}, {"24": ""}, {"79": "a629b5b37c9b16cb48c78d6cf5fe937d10ef54ad"}], "ctags": [{"_type": "tag", "name": "CREATE_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    CREATE_TEST_CASE = \"create_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "CREATE_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    CREATE_TEST_SCRIPT = \"create_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "DELETE_HISTORY", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    DELETE_HISTORY = \"delete_history\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "DELETE_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    DELETE_TEST_CASE = \"delete_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "DELETE_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    DELETE_TEST_SCRIPT = \"delete_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "EXECUTE_TEST", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    EXECUTE_TEST = \"execute_test\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "MANAGE_QUEUE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    MANAGE_QUEUE = \"manage_queue\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "MANAGE_ROLES", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    MANAGE_ROLES = \"manage_roles\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "MANAGE_USERS", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    MANAGE_USERS = \"manage_users\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "Permission", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^class Permission:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "READ_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    READ_TEST_CASE = \"read_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "READ_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    READ_TEST_SCRIPT = \"read_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "ROLE_PERMISSIONS", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^ROLE_PERMISSIONS = {$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "UPDATE_TEST_CASE", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    UPDATE_TEST_CASE = \"update_test_case\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "UPDATE_TEST_SCRIPT", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    UPDATE_TEST_SCRIPT = \"update_test_script\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "UserRoleModel", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^from ..database.models import User, Role, UserRole as UserRoleModel, UserRoleEnum$/", "language": "Python", "kind": "unknown", "nameref": "unknown:UserRole"}, {"_type": "tag", "name": "VIEW_AUDIT_LOGS", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    VIEW_AUDIT_LOGS = \"view_audit_logs\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "VIEW_HISTORY", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    VIEW_HISTORY = \"view_history\"$/", "language": "Python", "kind": "variable", "scope": "Permission", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^async def get_current_user($/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "( credentials: HTTPAuthorizationCredentials = Depends(security), db: Session = Depends(get_db) )"}, {"_type": "tag", "name": "get_user_roles", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^def get_user_roles(user: User, db: Session) -> List[UserRoleEnum]:$/", "language": "Python", "typeref": "typename:List[UserRoleEnum]", "kind": "function", "signature": "(user: User, db: Session)"}, {"_type": "tag", "name": "permission_checker", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^    def permission_checker($/", "file": true, "language": "Python", "kind": "function", "signature": "( current_user: User = Depends(get_current_user), db: Session = Depends(get_db) )", "scope": "require_permission", "scopeKind": "function"}, {"_type": "tag", "name": "require_admin", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^require_admin = require_permission(Permission.MANAGE_USERS)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "require_permission", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^def require_permission(permission: str):$/", "language": "Python", "kind": "function", "signature": "(permission: str)"}, {"_type": "tag", "name": "require_tester", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^require_tester = require_permission(Permission.EXECUTE_TEST)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "require_viewer", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^require_viewer = require_permission(Permission.READ_TEST_SCRIPT)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "security", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^security = HTTPBearer()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "user_has_permission", "path": "/home/kavia/workspace/code-generation/robot-framework-test-manager-fullstack-application-for-test-script-management-36-153/BackendAPI/src/auth/rbac.py", "pattern": "/^def user_has_permission(user: User, permission: str, db: Session) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(user: User, permission: str, db: Session)"}], "hash": "920e19a4fda9ebf8d6af136d61d88ad7", "format-version": 4, "code-base-name": "BackendAPI", "filename": "BackendAPI/src/auth/rbac.py", "fields": [{"name": "CREATE_TEST_CASE = \"create_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "CREATE_TEST_SCRIPT = \"create_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "DELETE_HISTORY = \"delete_history\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "DELETE_TEST_CASE = \"delete_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "DELETE_TEST_SCRIPT = \"delete_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "EXECUTE_TEST = \"execute_test\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "MANAGE_QUEUE = \"manage_queue\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "MANAGE_ROLES = \"manage_roles\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "MANAGE_USERS = \"manage_users\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "READ_TEST_CASE = \"read_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "READ_TEST_SCRIPT = \"read_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "ROLE_PERMISSIONS = {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UPDATE_TEST_CASE = \"update_test_case\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "UPDATE_TEST_SCRIPT = \"update_test_script\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "VIEW_AUDIT_LOGS = \"view_audit_logs\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "VIEW_HISTORY = \"view_history\"", "scope": "Permission", "scopeKind": "class", "description": "unavailable"}, {"name": "require_admin = require_permission(Permission.MANAGE_USERS)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "require_tester = require_permission(Permission.EXECUTE_TEST)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "require_viewer = require_permission(Permission.READ_TEST_SCRIPT)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "security = HTTPBearer()", "scope": "", "scopeKind": "", "description": "unavailable"}]}